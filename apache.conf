<VirtualHost *:80>
	ServerName r1.channing.bwh.harvard.edu
	DocumentRoot /var/www/html/
	ServerAdmin ross.lazarus@gmail.com
	#ProxyPreserveHost On

	Alias /media /var/www/html/djangomedia/ESP/media
	Alias /static /var/www/html/djangomedia/ESP/media
	Alias /ESP/media /var/www/html/djangomedia/ESP/media
	Alias /ESP/static /var/www/html/djangomedia/ESP/media

	RewriteEngine On
	RewriteLog /etc/httpd/logs/rewrite.log
	RewriteLogLevel 0
	RewriteRule ^/demo/$ /ESP/
	RewriteRule ^/ESP$ /ESP/
	RewriteRule ^/admin$ /ESP/admin/
	RewriteRule ^/admin/(.*)$ /ESP/admin/$1 [PT]
	RewriteRule ^/ESP/images/(.*)$ /media/$1
	RewriteRule ^/ESP/media/(.*)$ /media/$1
	RewriteRule ^/images/(.*)$ /djangomedia/media/$1 [L]
	RewriteRule ^/media/(.*)$ /djangomedia/media/$1 [L]

	<Location "/ESP">
		SetHandler python-program
		PythonPath "['/home/ESP'] + sys.path"
		PythonHandler django.core.handlers.modpython
		SetEnv DJANGO_SETTINGS_MODULE ESP.settings
		SetEnv PYTHON_EGG_CACHE /home/apache
		PythonOption django.root /ESP
		PythonDebug On
		allow from all
	</Location>

	<Location "/ESP/media/">
		SetHandler None
		Allow from all
	</Location>

	<Location "/ESP/images/">
		SetHandler None
		Allow from all
	</Location>

	<Location "/media/">
		SetHandler None
		Allow from all
	</Location>

	<Location "/images/">
		SetHandler None
		Allow from all
	</Location>

	<LocationMatch "\.(jpg|gif|png)$">
		SetHandler None
		Allow from all
	</LocationMatch>

	### Block all trace requests  (all vHosts need this!!)
	#
	# What exactly does this do?  -JM
	#
	Include conf/Global/TraceRequestsForbidden.conf
</VirtualHost>



