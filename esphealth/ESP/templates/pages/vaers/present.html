{% extends "vaers.html" %}
{% block extrastyle %}
<link rel="stylesheet" type="text/css" href="{{ site_css_folder }}vaers.css" />
{% endblock %}
{% block extrascript %}
<script type="text/javascript" src="{{ site_javascript_folder }}vaers.js">

</script>
{% endblock%}

{% block content %}

<b>Demographics</b>
<table id="tbl_patient_details">
  <tr>
  <th>Patient name</th>
    <td>{{ case.patient.full_name  }}</td>
  </tr> 
  <tr>
    <th>Gender</th>
    <td>{{ case.patient.gender }}</td>
  </tr>
  <tr>
    <th>Date of birth</th>
    <td>{{ case.patient.date_of_birth|date:"d-M-Y" }}</td>
  </tr> 
  <tr>
    <th>Race</th>
    <td>{{ case.patient.race }}</td>
  </tr> 
  <tr>
    <th>Home address</th>
    <td>{{ case.patient.address1 }} {{ case.patient.city }} {{ case.patient.state }} {{ case.patient.zip5 }} {{ case.patient.country }}</td>
  </tr>
  <tr>
    <th>Telephone number</th>
    <td>({{ case.patient.areacode }}) {{ case.patient.tel }}</td>
  </tr> 
</table>
<br>
<b>Reporting clinician</b>
<table id="tbl_provider_details">
  <tr>
  <th>Clinician name</th>
    <td>{{ questionaire.provider.full_name  }}</td>
  </tr> 
  <tr>
  <th>Practice address</th>
    <td>{{ questionaire.provider.dept_address_1 }} {{ questionaire.provider.dept_city }} {{ questionaire.provider.dept_state }} {{ questionaire.provider.dept_zip }}</td>
  </tr> 
  <tr>
  <th>Practice phone number</th>
    <td>({{ questionaire.provider.areacode  }}) {{ questionaire.provider.telephone }} </td>
  </tr> 
</table>
<br>
<b>Vaccine data</b>
<table id="tbl_vaccine_details">

  <tr><th>Vaccine name</th>
    <td>
 	{{ case.immunization.name }} - {{ case.immunization.vaccine_type }} 
    </td>
  </tr>
  <tr><th>Date of administration</th>
    <td>
 	 {{ case.immunization.date|date:"M d, Y"}}
    </td>
    </tr>
  <tr><th>Vaccine lot number</th>
    <td>
 	 {{ case.immunization.lot}}
    </td>
  </tr>
  
</table>
<BR>
<b>Clinical event</b>

<table id="tbl_case_details">
{% for event in case.adverse_event.all %}
  <tr>
  <th>Event name:</th>
    <td>{{ event.matching_rule_explain }}</td>
  </tr>
  
  {% ifequal content_type_enc event.content_type %}
  <tr>
    <th>Event value:</th>
    <td>Icd9 codes:
      <ul>
	{% for icd9 in event.content_object.icd9_codes.all %}
	<li>{{ icd9.code }} ({{ icd9.name }})</li>
	{% endfor %}
      </ul>
    </td>
    <tr/>
    <th>Encounter type: </th>
    <td>  {{ event.content_object.encounter_type}} </td>
    <tr/>
    <th>Encounter date: </th>
    <td>  {{ event.content_object.date|date:"d-M-Y"}} </td>
  </tr>
  {% endifequal %}
  
   {% ifequal content_type_lx event.content_type %}
  <tr>
    <th>Event value: </th>
    <td>
      <ul class="lx_summary">
     <li>Result date: {{event.content_object.result_date|date:"d-M-Y"}}</li>
	 <li>Value: {{ event.content_object.result_float|default:"N/A"}}</li>
      </ul>
    </td>
  </tr>
  {% endifequal %}
  
   {% ifequal content_type_rx event.content_type %}
  <tr>
    <th>Event value: </th>
    <td>
      <ul class="lx_summary">
	<li>Prescription name: {{ event.content_object.name }}</li>
	<li>Dose: #{{ event.content_object.dose }}</li>
	<li>Date:{{ event.content_object.date|date:"d-M-Y" }}</li>
	 </ul>
    </td>
  </tr>
  {% endifequal %}
  
   {% ifequal content_type_all event.content_type %}
  <tr>
    <th>Event value: </th>
    <td>
      <ul class="lx_summary">
	<li>Allergy name: {{ event.content_object.name }}</li>
	<li>Date noted: {{ event.content_object.date_noted|date:"d-M-Y" }}</li>
      </ul>

  </tr>
  {% endifequal %}
  
  <tr>
  <th>Event date</th>
    <td>{{ event.created_on|date:"d-M-Y"}}  </td>
  </tr>
  <tr>
  <th>Time since vaccination</th>
    <td>{{ event.gap }} days </td>
  </tr>
  {% endfor %}
</table>
  
<form id="frm_case_confirmation" method="POST" action="{% url present_case questionaire.id  %}">
 <B>
   {{ form.as_ul }}
 </B>
  <input type="submit" value="submit" />
  {% csrf_token %}
</form>
{% endblock %}
