unit test case documentation for esp
author: carolina chacin
updated: dec 12 2011


VAERS (call set rules first one time. save in backup and move after sync db.)
5 patients (should generate 5 cases)	
(all encounters have to be in the non specialty site for urgent care)
1 patient with 1 encounter with a diagnostic in the list of VAERS_DIAGNOSTICS (bells) in rules.py that has an ignore period 12
  same patient with 1 encounter with same diagnostic in the list of VAERS_DIAGNOSTICS 
  that has an ignore period 12 and that happened within the ignore period of above encounter (plat)
  same patient with immunization 60 days prior to first dx 
1 patient with 1 encounter with a diagnostic in the list of VAERS_DIAGNOSTICS (has seizures febrile and rotq) that does not have an ignore period (patri)
   same patient with immunization 60 days prior to dx 
1 patient with 1 lab test in the list of VAERS_LAB_RESULTS that meets the criteria of one defined in rules.py (who r)
 same patient with immunization 60 days prior to lab. 
1 patient with an immunization from table static.vaccine 
  same patient with 1 encounter with fever (temp > 100.4), and set to URGENT CARE 
  within TIME_WINDOW_POST_EVENT (60 days) immunization. (klompas) 
1 patient with 1 encounter with a diagnostic in the list of VAERS_DIAGNOSTIc (guilian barre) 
  that has an ignore period 12 but not in the specialty clinic.  (klruska)
  same patient with immunization within 60 days prior to dx

SS
3 patients (should generate 2 cases)
1 patient with 1 encounter with icd9 fever code defined in influenza_like_illness from definitions.py
 with temperature > 100.0 set with sites on a non specialty clinic and URGENT CARE
1 patient with 1 encounter with icd9 fever code and influenza_like_illness defined in ICD9_FEVER_CODES with 
  temperature not recorded set with sites on a non specialty clinic and URGENT CARE
1 patient with 1 encounter with icd9 code defined in influenza_like_illness from definitions.py
 with temperature < 100.0 set with sites on a non specialty clinic and URGENT CARE. NEG
   ??? not ili
1 patient with encounter with an icd9 code that requires fever (see rash icd9 codes in definistions.py) 
defined in OptionalFeverSyndromeHeuristic and an icd9 code of fever or a temperature >100
1 patient with an encounter with icd9 code defined in SyndromeHeuristic (see 'lesions' in definitins.py)


LYME
5 patients (should generate 4 cases)
4 patients with an encounter with icd9 code in the lyme_diagnosis. 
1st/4  patient with meds doxycycline within 14 days of diagnosis (lyme2)
2nd/4 patient with meds lyme_other_antibiotics in lyme.py within 14 days of diagnosis (lyme2)
3rd/4 patient with one test positive lab in 'lyme_elisa', 'lyme_igg', 'lyme_igm', 'lyme_pcr'
   positive within 30 days of diagnosis (lyme1)
4th/4 patient only encounter. NEG
1 patient with an encounter with icd9 code for rash (lyme 3)
same patient with laborder lyme_elisa within 14 days of diagnosis 
same patient with med doxycycline within 14 days of diagnosis

pid
2 patients (should generate 3 cases)
1  patients with chlamydia or gonorrhea positive test  
2 patient with 2 encounters each with icd9 code for pid within 28 days of test
1/2 encounter for one patient with icd9 code for pid after recurring days ??? 28 or 365
2/2 encounter for separate patient with encounter with icd9 code for pid within recurring days. NEG

chlamydia
3 patients (should generate 2 cases)
1 patient with chla test positive
same patient with chlal test positive after recurrence days 
1 patient with chla test negative
1 patient with chla test positive within recurrence days (28). NEG

syphillis from version 3
4 patients (should generate 3 cases)
1 patient with an encounter with icd9 code for syphilis
same patient with a prescription in syphilis.py within 14 days of encounter
2 patient with a lab positive for rpr 
1/2 patient a lab positive for ttpa, fta-abs  or tp-igg
2/2 patient a lab negative for ttpa, fta-abs  or tp-igg . NEG
1 patient with a lab positive for vrdl 

pertussis
3 patients (should generate 3 cases)
2 patient with an encounter with icd9 code for pertussis. one is NEG.
1 patient with a lab order for one of the labs in defs.py
 ( 'pertussis_pcr_order','pertussis_culture_order',  'pertussis_serology_order',)
2 (1 same as encounter, one same as lab) patient with med antibiotic prescription within 7 days of diagnosis
1 patient with positive lab for pertussis_pcr or pertussis_culture
      
tb
5 patients (should generate 4 cases)
1 patient with med pyrazinamide 
4 patients with encounter with tb diagnosis
1/4 patient with tb laborder ('myco', 'afb', 'tb', 'tuber',) within 14 days after diagnosis
2/4 patient with lab order  within 60 days prior or after diagnosis
3/4 patient with SECONDARY_MED_EVENTS in TuberculosisDefC class in models.py
1 patient with SECONDARY_MED_EVENTS in TuberculosisDefC class in models.py with no diagnosis. NEG
4/4 patient with tb lab order after 14 days. NEG

acute hep a
3 patients ( should generate 3 cases)
1 patients with encounter with icd9 for jaundice
1 patient with lab alt_2x 
both patients patient with lab igm positive
second patient with a lab test ('hep', 'alt', 'ast', 'tbil', 'bili') within 14 days of diagnosis
1 patient with alt_2x and lab igm positive within more than 14 days

diabetes
10  patients 
 conditions: 
    - Pre-diabetes -
    4 patients with enconter with icd9 following:
    type 1 (250.1, 250.3 (stated - uncontrolled
    type 2 250.0, 250.2
    - Frank Diabetes (has to have type 1 and 2)
    - Gestational Diabetes: 1 patient with encounter with icd9 '648.8'
    all types 1 patient with encounter with icd9 starts with 250.
    1 patient with meds 'insulin'
    1 patient with tert pos 'islet-cell-antibody'
    1 patient with test pos cholesterol:  'cholesterol-hdl',
            'cholesterol-ldl',
            'cholesterol-total',
            'triglycerides',
    1 patient with         
   1 patient with any result test in 'c-peptide',
            # Complete OGTT75 series
            'ogtt75-fasting',
            'ogtt75-30min',
            'ogtt75-1hr',
            'ogtt75-90min',
            'ogtt75-2hr',
            
   1 patient with pos test  'ogtt100-fasting-urine',
   1 patient with test with any of these threshold tests:
    # Fasting OGTT
            ('ogtt50-fasting', 'gte', 126),
            ('ogtt75-fasting', 'gte', 126),
            ('ogtt100-fasting', 'gte', 126),
            # OGTT50
            ('ogtt50-fasting', 'gte', 190),
            ('ogtt50-1hr', 'gte', 190),
            # OGTT75
            ('ogtt75-fasting', 'gte', 92),
            ('ogtt75-fasting', 'gte', 126),
            ('ogtt75-30m', 'gte', 200),
            ('ogtt75-1hr', 'gte', 180),
            ('ogtt75-1hr', 'gte', 200),
            ('ogtt75-90m', 'gte', 180),
            ('ogtt75-90m', 'gte', 200),
            ('ogtt75-2hr', 'gte', 153),
            ('ogtt75-2hr', 'gte', 200),
            # OGTT100
            ('ogtt100-fasting', 'gte', 95),
            ('ogtt100-30m', 'gte', 200),
            ('ogtt100-1hr', 'gte', 180),
            ('ogtt100-90m', 'gte', 180),
            ('ogtt100-2hr', 'gte', 155),
            ('ogtt100-3hr', 'gte', 140),
            ('ogtt100-4hr', 'gte', 140),
            ('ogtt100-5hr', 'gte', 140),
            # Auto-antibodies
            ('gad65', 'gt', 1),
            ('ica512', 'gt', 0.8),
            # A1C
            ('a1c', 'gte', 6.5),
            # C-Peptide
            ('c-peptide', 'lt', 0.8),
     1 patient with test in range 
     ('a1c', 5.7, 6.4),
            ('glucose-fasting', 100, 125),
            ('ogtt50-random', 140, 200),
            ('ogtt75-fasting', 100, 125),
            ('ogtt75-30m', 140, 199),
            ('ogtt75-1hr', 140, 199),
            ('ogtt75-90m', 140, 199),
            ('ogtt75-2hr', 140, 199),                

Gonorrhea
hep b
hep c
Giardiasis



